(this.webpackJsonpmy_snapchat=this.webpackJsonpmy_snapchat||[]).push([[0],{18:function(e,t,a){e.exports=a(42)},23:function(e,t,a){},24:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(15),l=a.n(r),s=(a(23),a(1)),o=(a(24),a(4)),i=a(3);var m=function(e){var t=Object(n.useState)(),a=Object(s.a)(t,2),r=a[0],l=a[1];function m(e){l(Object(i.a)(Object(i.a)({},r),{},Object(o.a)({},e.target.name,e.target.value)))}return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-lg-5"},e.registered&&c.a.createElement("h4",{className:"mb-4 text-center text-success"},"Registered successfully, please login."),c.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.handleSubmit(r)},className:"px-5"},e.errorMessage&&c.a.createElement("h5",{className:"text-danger"},e.errorMessage),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"white text-left"},"Email"),c.a.createElement("input",{type:"text",className:"form-control",name:"email",onChange:m})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"white text-left"},"Password"),c.a.createElement("input",{type:"password",className:"form-control",name:"password",onChange:m})),c.a.createElement("div",{className:"text-center mt-4"},c.a.createElement("small",{className:"form-text text-white"},"Don't have an account yet ? ",c.a.createElement("span",{onClick:function(){return e.handleClick("register")}},c.a.createElement("b",null,c.a.createElement("u",null,"Sign up")))),c.a.createElement("button",{type:"submit",className:"btn btn-warning white mt-3"},"Login"))))))};var u=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),r=a[0],l=a[1],m=Object(n.useState)(!1),u=Object(s.a)(m,2),d=u[0],p=u[1];function f(e){l(Object(i.a)(Object(i.a)({},r),{},Object(o.a)({},e.target.name,e.target.value)))}return Object(n.useEffect)((function(){e.errorMessage&&p({email:e.errorMessage})}),[e.errorMessage]),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-lg-5"},c.a.createElement("form",{onSubmit:function(t){t.preventDefault();var a={};r.email?/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(r.email)||(a.email="Please enter a correct email adress"):a.email="Email required",r.password?r.password.length<5&&(a.password="Your password need to be at least 5 characters long"):a.password="Password required",r.cpassword?r.cpassword!==r.password&&(a.cpassword="Password do not match"):a.cpassword="Password confirmation required",0===Object.keys(a).length?(e.handleSubmit(r),p(a)):p(a)},className:"px-5"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"white"},"Email"),c.a.createElement("input",{type:"text",className:"form-control "+(d.email?"is-invalid":""),name:"email",onChange:f}),c.a.createElement("div",{className:"invalid-feedback"},d.email)),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"white"},"Password"),c.a.createElement("input",{type:"password",className:"form-control "+(d.password?"is-invalid":""),name:"password",onChange:f}),c.a.createElement("div",{className:"invalid-feedback"},d.password)),c.a.createElement("div",{className:"form-group has-danger"},c.a.createElement("label",{className:"white"},"Confirm Password"),c.a.createElement("input",{type:"password",className:"form-control "+(d.cpassword?"is-invalid":""),name:"cpassword",onChange:f}),c.a.createElement("div",{className:"invalid-feedback"},d.cpassword)),c.a.createElement("div",{className:"text-center mt-4"},c.a.createElement("small",{className:"form-text text-white"},"Already have an account ? ",c.a.createElement("span",{onClick:function(){return e.handleClick("login")}},c.a.createElement("b",null,c.a.createElement("u",null,"login")))),c.a.createElement("button",{type:"submit",className:"btn btn-warning white mt-3"},"Sign up"))))))};var d=function(e){return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-lg-5 px-5"},c.a.createElement("button",{type:"button",className:"btn btn-warning btn-lg btn-block mb-4",onClick:function(t){t.preventDefault(),e.handleClick("register")}},"Sign up"),c.a.createElement("button",{type:"button",className:"btn btn-primary btn-lg btn-block",onClick:function(t){t.preventDefault(),e.handleClick("login")}},"Login"))))},p=a(16),f=a.n(p),E=a(5),b=a.n(E);function h(){var e=b.a.getJSON("user");return e.token?{token:e.token}:{}}var v=f.a.create({baseURL:"http://snapi.epitech.eu/",timeout:1500});function g(){return v.get("/snaps",{headers:h()})}var N=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),r=a[0],l=a[1];function o(e){l("register"===e?c.a.createElement(u,{handleSubmit:i,handleClick:o}):c.a.createElement(m,{handleSubmit:p,handleClick:o}))}function i(e){var t,a;l(c.a.createElement(u,{handleSubmit:i,handleClick:o,errorMessage:null})),(t=e.email,a=e.password,v.post("/inscription",{email:t,password:a},{headers:{"Content-Type":"application/json"}})).then((function(){l(c.a.createElement(m,{handleSubmit:p,handleClick:o,loginEmail:e.email,registered:!0}))})).catch((function(){l(c.a.createElement(u,{handleSubmit:i,handleClick:o,errorMessage:"Email already taken."}))}))}function p(t){var a,n;l(c.a.createElement(m,{handleSubmit:p,handleClick:o,loginEmail:t.email,errorMessage:null})),(a=t.email,n=t.password,v.post("/connection",{email:a,password:n},{headers:{"Content-Type":"application/json"}})).then((function(t){!function(e,t){b.a.set("user",{email:e,token:t},{expires:7})}(t.data.data.email,t.data.data.token),e.handleLogin(t.data.data.email)})).catch((function(){l(c.a.createElement(m,{handleSubmit:p,handleClick:o,loginEmail:t.email,errorMessage:"Incorrect email or password."}))}))}return c.a.createElement("div",{className:"login-index"},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"https://cdn.frankerfacez.com/emoticon/145916/4",alt:"KKOMRADE"}),c.a.createElement("h1",{className:"text-center"},"Our Snapchat")),c.a.createElement("div",{className:"d-flex flex-column justify-content-center vh-100"},r||c.a.createElement(d,{handleClick:o})))};var w=function(e){var t=URL.createObjectURL(e.imageFile),a=Object(n.useState)([]),r=Object(s.a)(a,2),l=r[0],o=r[1];return Object(n.useEffect)((function(){v.get("/all",{headers:h()}).then((function(e){o(e.data.data)}))}),[]),c.a.createElement("div",{className:"px-2 pt-0 test"},c.a.createElement("img",{src:t,className:"apercuSnap",alt:"snapPreview"}),c.a.createElement("div",{className:"px-5"},c.a.createElement("select",{id:"selectDuration"},c.a.createElement("option",{value:"3"},"3"),c.a.createElement("option",{value:"5"},"5"),c.a.createElement("option",{value:"10"},"10"),c.a.createElement("option",{value:"15"},"15")),c.a.createElement("select",{id:"selectRecipient"},l.map((function(e){return c.a.createElement("option",{key:e.email},e.email)}))),c.a.createElement("button",{className:"sendsnap",onClick:function(){var t,a=document.getElementById("selectDuration").value,n=document.getElementById("selectRecipient").value,c=new FormData;c.set("to",n),c.set("duration",a),c.append("image",e.imageFile),(t=c,v.post("/snap",t,{headers:Object(i.a)({"Content-Type":"multipart/form-data"},h())})).then((function(){console.log("sent")})).catch((function(){console.log("error")})),e.handleClick("send")}},"Send ",c.a.createElement("i",{className:"fas fa-paper-plane"}))),c.a.createElement("p",{className:"mt-3 w-100 text-center text-white",onClick:function(){return e.handleClick("send")}},c.a.createElement("u",null,"Take another picture")))},k=a(17),j=a.n(k);var O=function(e){var t=c.a.useRef(null),a=c.a.useCallback((function(){var a=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),c=0;c<t.length;c++)n[c]=t.charCodeAt(c);return new Blob([n],{type:a})}(t.current.getScreenshot());e.handleImg(a)}),[t,e]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(j.a,{audio:!1,ref:t,screenshotFormat:"image/png"}),c.a.createElement("button",{onClick:a,className:"btn btn-primary w-100"},"Capture photo"))};var S=function(e){return c.a.createElement("div",{className:"px-5"},c.a.createElement("label",{className:"labelfile"},c.a.createElement("p",{className:"choiceSnap"},"Choose Image"),c.a.createElement("input",{type:"file",className:"inputfile",onChange:function(t){e.handleImg(t.target.files[0])}})),c.a.createElement(O,{handleImg:e.handleImg}))};var C=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),r=a[0],l=a[1];function o(e){l(c.a.createElement(w,{handleClick:i,imageFile:e}))}function i(e){l(e="snaped"===e?c.a.createElement(w,{handleClick:i}):c.a.createElement(S,{handleClick:i,handleImg:o}))}return c.a.createElement("div",{className:"login-index"},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"https://cdn.frankerfacez.com/emoticon/145916/4",alt:"KKOMRADE"}),c.a.createElement("h1",{className:"text-center"},"Take a Snap")),c.a.createElement("div",{className:"d-flex flex-column justify-content-center vh-100"},r||c.a.createElement(S,{handleClick:i,handleImg:o})))};var x=function(e){var t=e.from,a=e.duration,n=e.id;return c.a.createElement("div",{className:"list-item my-1 mx-2 d-flex justify-content-between"},c.a.createElement("h3",{className:"text-center text-white w-100",onClick:function(){return e.showSnap(n,t,a)}},t))};var y=function(e){var t=e.snaps;return c.a.createElement("div",{className:"snaplist"},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"https://cdn.frankerfacez.com/emoticon/145916/4",alt:"KKOMRADE"}),c.a.createElement("h1",{className:"text-center"},"Your Snaps")),c.a.createElement("div",{className:"container px-3"},c.a.createElement("div",{className:"list px-2"},t.map((function(t){return c.a.createElement(x,{key:t.snap_id,showSnap:e.showSnap,id:t.snap_id,from:t.from,duration:t.duration})})))),c.a.createElement("button",{className:"btn btn-secondary btn-refresh",onClick:e.updateSnaps},"refresh"))};var I=function(e){var t=e.from,a=e.duration,r=e.imageData,l=Object(n.useState)(a),o=Object(s.a)(l,2),i=o[0],m=o[1];return Object(n.useEffect)((function(){var t;return e.startCounter&&(t=setInterval((function(){m((function(e){return e-1}))}),1e3)),function(){return clearInterval(t)}}),[e.startCounter]),c.a.createElement("div",{className:"px-4"},c.a.createElement("div",{className:"snap-frame h-50"},c.a.createElement("img",{src:r,className:"snap-image",alt:"snapimage"})),c.a.createElement("h3",{className:"text-white text-center mb-3"},"From : ",t),c.a.createElement("h1",{className:"counter-strike text-white text-center"},i),c.a.createElement("button",{className:"btn-back btn btn-lg btn-block btn-secondary mt-3",onClick:e.updateSnaps},"Back"))};var D=function(e){var t=e.id,a=e.from,r=e.duration,l=e.updateSnaps,o=Object(n.useState)(),m=Object(s.a)(o,2),u=m[0],d=m[1],p=Object(n.useState)(!1),f=Object(s.a)(p,2),E=f[0],b=f[1],g=Object(n.useState)(!1),N=Object(s.a)(g,2),w=N[0],k=N[1];return Object(n.useEffect)((function(){(function(e){return v.get("/snap/"+e,{headers:h(),responseType:"blob"})})(t).then((function(e){var a=new Image;a.src=URL.createObjectURL(e.data),d(a.src),k(!0),function(e){v.post("/seen",{id:e},{headers:Object(i.a)(Object(i.a)({},h()),{},{"Content-Type":"application/json"})})}(t)})).catch((function(){b(!0)}));var e=setTimeout((function(){l()}),1e3*r);return function(){return clearTimeout(e)}}),[r,t,l]),c.a.createElement("div",null,E?c.a.createElement("h1",{className:"text-white text-center mt-5"},"Snap deleted"):c.a.createElement(I,{startCounter:w,updateSnaps:e.updateSnaps,from:a,duration:r,imageData:u}))};var M=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)([]),i=Object(s.a)(o,2),m=i[0],u=i[1];function d(){g().then((function(e){u(e.data.data),l(!1)})).catch((function(e){return console.log(e)}))}return Object(n.useEffect)((function(){function e(){g().then((function(e){u(e.data.data)})).catch((function(e){return console.log(e)}))}e();var t=setInterval((function(){e()}),1e4);return function(){return clearInterval(t)}}),[]),c.a.createElement("div",null,r||c.a.createElement(y,{snaps:m,showSnap:function(e,t,a){l(c.a.createElement(D,{id:e,from:t,duration:a,updateSnaps:d}))},updateSnaps:d}))};var R=function(e){var t=Object(n.useState)(c.a.createElement(M,null)),a=Object(s.a)(t,2),r=a[0],l=a[1];return c.a.createElement("div",{className:"px-0"},r,c.a.createElement("div",{className:"navigation d-flex justify-content-between"},c.a.createElement("button",{type:"button",className:"btn btn-primary btn-lg",onClick:function(){l(c.a.createElement(C,null))}},"Send"),c.a.createElement("button",{type:"button",className:"btn btn-primary btn-lg",onClick:function(){l(c.a.createElement(M,null))}},"Snaps"),c.a.createElement("button",{type:"button",className:"btn btn-danger btn-lg",onClick:e.handleLogout},"log out")))};var L=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=function(){var e=b.a.getJSON("user");if(e)return e}();e&&r(e.email)}),[]),c.a.createElement("div",null,a?c.a.createElement(R,{handleLogout:function(){r(!1),b.a.remove("user")}}):c.a.createElement(N,{handleLogin:function(e){r(e)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.d6d6f6ef.chunk.js.map